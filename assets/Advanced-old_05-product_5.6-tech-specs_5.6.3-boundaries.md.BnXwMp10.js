import{_ as k,C as r,c as d,o as a,a3 as n,b as t,w as i,a as p,G as h,a4 as e}from"./chunks/framework.CUcrqFol.js";const B=JSON.parse('{"title":"5.6.3 哪里归我管——系统边界：内部组件与外部依赖","description":"5.6.3 哪里归我管——系统边界 一句话破题 系统边界定义**哪些是自己开发的、哪些是依赖外部的**。 为什么要划分边界 边界清晰才能： 知道什么问题找谁解决 评估哪些是可控的、哪些有风险 制定备选方案 内部组件 vs 外部依赖 依赖关系图 外部依赖清单 风险评估 每个外部依赖都要考虑： | 风险类型 | 问题 |","frontmatter":{"title":"5.6.3 哪里归我管——系统边界：内部组件与外部依赖","typora-root-url":"../../public"},"headers":[],"relativePath":"Advanced-old/05-product/5.6-tech-specs/5.6.3-boundaries.md","filePath":"Advanced-old/05-product/5.6-tech-specs/5.6.3-boundaries.md","lastUpdated":1766168364000}'),E={name:"Advanced-old/05-product/5.6-tech-specs/5.6.3-boundaries.md"};function g(o,s,c,y,A,F){const l=r("Mermaid");return a(),d("div",null,[s[2]||(s[2]=n('<h1 id="_5-6-3-哪里归我管——系统边界" tabindex="-1">5.6.3 哪里归我管——系统边界 <a class="header-anchor" href="#_5-6-3-哪里归我管——系统边界" aria-label="Permalink to &quot;5.6.3 哪里归我管——系统边界&quot;">​</a></h1><h3 id="一句话破题" tabindex="-1">一句话破题 <a class="header-anchor" href="#一句话破题" aria-label="Permalink to &quot;一句话破题&quot;">​</a></h3><p>系统边界定义<strong>哪些是自己开发的、哪些是依赖外部的</strong>。</p><h3 id="为什么要划分边界" tabindex="-1">为什么要划分边界 <a class="header-anchor" href="#为什么要划分边界" aria-label="Permalink to &quot;为什么要划分边界&quot;">​</a></h3>',4)),(a(),t(e,null,{default:i(()=>[h(l,{id:"mermaid-12",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20subgraph%20%22%E6%88%91%E7%9A%84%E7%B3%BB%E7%BB%9F%22%0A%20%20%20%20%20%20%20%20A%5B%22Next.js%20%E5%BA%94%E7%94%A8%22%5D%0A%20%20%20%20%20%20%20%20B%5B%22API%20Routes%22%5D%0A%20%20%20%20%20%20%20%20C%5B%22Prisma%20ORM%22%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20%22%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%22%0A%20%20%20%20%20%20%20%20D%5B%22PostgreSQL%22%5D%0A%20%20%20%20%20%20%20%20E%5B%22Vercel%20%E6%89%98%E7%AE%A1%22%5D%0A%20%20%20%20%20%20%20%20F%5B%22GitHub%20OAuth%22%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20A%20--%3E%20B%0A%20%20%20%20B%20--%3E%20C%0A%20%20%20%20C%20--%3E%20D%0A%20%20%20%20A%20--%3E%20E%0A%20%20%20%20A%20--%3E%20F%0A"})]),fallback:i(()=>[...s[0]||(s[0]=[p(" Loading... ",-1)])]),_:1})),s[3]||(s[3]=n(`<p>边界清晰才能：</p><ul><li>知道什么问题找谁解决</li><li>评估哪些是可控的、哪些有风险</li><li>制定备选方案</li></ul><h3 id="内部组件-vs-外部依赖" tabindex="-1">内部组件 vs 外部依赖 <a class="header-anchor" href="#内部组件-vs-外部依赖" aria-label="Permalink to &quot;内部组件 vs 外部依赖&quot;">​</a></h3><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## 博客系统边界划分</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### 内部组件（自己实现）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| 组件 | 说明 | 可控性 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|------|------|--------|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| 前端页面 | Next.js React 组件 | 完全可控 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| API 接口 | Next.js API Routes | 完全可控 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| 数据访问 | Prisma ORM 调用 | 完全可控 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| 业务逻辑 | 文章/用户/分类管理 | 完全可控 |</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### 外部依赖（使用服务）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| 依赖 | 用途 | 可替换性 | 风险 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|------|------|----------|------|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| PostgreSQL | 数据存储 | 中（换 MySQL） | 低 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| Vercel | 部署托管 | 高（换 Railway） | 低 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| GitHub OAuth | 用户认证 | 中（换 Google） | 低 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| Cloudinary | 图片存储 | 高（换 OSS） | 低 |</span></span></code></pre></div><h3 id="依赖关系图" tabindex="-1">依赖关系图 <a class="header-anchor" href="#依赖关系图" aria-label="Permalink to &quot;依赖关系图&quot;">​</a></h3>`,5)),(a(),t(e,null,{default:i(()=>[h(l,{id:"mermaid-40",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20subgraph%20%22%E5%89%8D%E7%AB%AF%22%0A%20%20%20%20%20%20%20%20A%5B%22React%20%E7%BB%84%E4%BB%B6%22%5D%0A%20%20%20%20%20%20%20%20B%5B%22%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%22%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20%22%E5%90%8E%E7%AB%AF%22%0A%20%20%20%20%20%20%20%20C%5B%22API%20Routes%22%5D%0A%20%20%20%20%20%20%20%20D%5B%22Service%20%E5%B1%82%22%5D%0A%20%20%20%20%20%20%20%20E%5B%22Prisma%20Client%22%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20%22%E5%A4%96%E9%83%A8%E6%9C%8D%E5%8A%A1%22%0A%20%20%20%20%20%20%20%20F%5B%22PostgreSQL%22%5D%0A%20%20%20%20%20%20%20%20G%5B%22Redis%20%E7%BC%93%E5%AD%98%22%5D%0A%20%20%20%20%20%20%20%20H%5B%22%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%22%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20A%20--%3E%20C%0A%20%20%20%20C%20--%3E%20D%0A%20%20%20%20D%20--%3E%20E%0A%20%20%20%20E%20--%3E%20F%0A%20%20%20%20D%20--%3E%20G%0A%20%20%20%20D%20--%3E%20H%0A"})]),fallback:i(()=>[...s[1]||(s[1]=[p(" Loading... ",-1)])]),_:1})),s[4]||(s[4]=n(`<h3 id="外部依赖清单" tabindex="-1">外部依赖清单 <a class="header-anchor" href="#外部依赖清单" aria-label="Permalink to &quot;外部依赖清单&quot;">​</a></h3><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## 外部依赖清单</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### 基础设施</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| 服务 | 用途 | 免费额度 | 付费价格 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|------|------|----------|----------|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| Vercel | 托管 | 100GB/月 | $20/月起 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| Supabase | 数据库 | 500MB | $25/月起 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| Cloudflare | CDN | 无限 | 免费 |</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### 第三方 API</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| 服务 | 用途 | 免费额度 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|------|------|----------|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| GitHub OAuth | 登录 | 免费 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| Resend | 邮件 | 100封/天 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| Sentry | 错误监控 | 5K事件/月 |</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### npm 依赖</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| 包 | 用途 | 活跃度 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|----|------|--------|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| @prisma/client | ORM | 活跃 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| next-auth | 认证 | 活跃 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| zod | 验证 | 活跃 |</span></span></code></pre></div><h3 id="风险评估" tabindex="-1">风险评估 <a class="header-anchor" href="#风险评估" aria-label="Permalink to &quot;风险评估&quot;">​</a></h3><p>每个外部依赖都要考虑：</p><table tabindex="0"><thead><tr><th>风险类型</th><th>问题</th><th>应对方案</th></tr></thead><tbody><tr><td><strong>可用性</strong></td><td>服务宕机怎么办</td><td>准备备选服务</td></tr><tr><td><strong>成本</strong></td><td>超出免费额度怎么办</td><td>设置用量告警</td></tr><tr><td><strong>迁移</strong></td><td>需要换服务怎么办</td><td>抽象接口层</td></tr><tr><td><strong>安全</strong></td><td>API Key 泄露怎么办</td><td>环境变量 + 权限控制</td></tr></tbody></table><h3 id="依赖抽象" tabindex="-1">依赖抽象 <a class="header-anchor" href="#依赖抽象" aria-label="Permalink to &quot;依赖抽象&quot;">​</a></h3><p>为了降低依赖风险，可以做一层抽象：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 不好：直接耦合</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { S3Client } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@aws-sdk/client-s3&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> client</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> S3Client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 好：抽象接口</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> StorageService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  upload</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> S3Storage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> StorageService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> upload</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LocalStorage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> StorageService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> upload</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="让-ai-帮你分析依赖" tabindex="-1">让 AI 帮你分析依赖 <a class="header-anchor" href="#让-ai-帮你分析依赖" aria-label="Permalink to &quot;让 AI 帮你分析依赖&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>你：分析我的博客系统有哪些外部依赖，评估风险</span></span>
<span class="line"><span></span></span>
<span class="line"><span>AI：## 依赖分析</span></span>
<span class="line"><span></span></span>
<span class="line"><span>### 高依赖（必须有）</span></span>
<span class="line"><span>1. **PostgreSQL 数据库**</span></span>
<span class="line"><span>   - 风险：中等（托管服务可能变更）</span></span>
<span class="line"><span>   - 备选：自建 / 换 MySQL</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>2. **Vercel 托管**</span></span>
<span class="line"><span>   - 风险：低（可快速迁移）</span></span>
<span class="line"><span>   - 备选：Railway / Fly.io</span></span>
<span class="line"><span></span></span>
<span class="line"><span>### 中依赖（可替换）</span></span>
<span class="line"><span>1. **GitHub OAuth**</span></span>
<span class="line"><span>   - 风险：低</span></span>
<span class="line"><span>   - 备选：Google OAuth / 邮箱密码</span></span>
<span class="line"><span></span></span>
<span class="line"><span>### 低依赖（锦上添花）</span></span>
<span class="line"><span>1. **Google Analytics**</span></span>
<span class="line"><span>   - 风险：很低</span></span>
<span class="line"><span>   - 备选：Umami / 不用</span></span></code></pre></div><h3 id="实用建议" tabindex="-1">实用建议 <a class="header-anchor" href="#实用建议" aria-label="Permalink to &quot;实用建议&quot;">​</a></h3><ol><li><strong>列出所有依赖</strong>：包括 npm 包和云服务</li><li><strong>评估替换成本</strong>：哪些是容易换的</li><li><strong>关键依赖要抽象</strong>：方便未来迁移</li><li><strong>监控依赖健康</strong>：关注服务状态和版本更新</li></ol>`,12))])}const b=k(E,[["render",g]]);export{B as __pageData,b as default};
