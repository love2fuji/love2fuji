import{_ as s,c as t,o as n,a3 as o}from"./chunks/framework.CUcrqFol.js";const g=JSON.parse('{"title":"4.4.2 使用本地存储（localStorage）","description":"4.4.2 使用本地存储（localStorage） **本步目标**：让 AI 帮我们实现数据的自动保存和读取 本节是数据存储的核心实现。我们会分两步完成：先实现「保存」，再实现「读取」。 技术小贴士：理解 localStorage 在开始之前，用一个生活类比帮你建立直觉： | 生活场景 | 对应概念 | |----","frontmatter":{"title":"4.4.2 使用本地存储（localStorage）","order":3},"headers":[],"relativePath":"Basic/04-practice-0-to-1/4.4-data-storage/4.4.2-localstorage.md","filePath":"Basic/04-practice-0-to-1/4.4-data-storage/4.4.2-localstorage.md","lastUpdated":1765094268000}'),e={name:"Basic/04-practice-0-to-1/4.4-data-storage/4.4.2-localstorage.md"};function l(p,a,i,r,d,c){return n(),t("div",null,[...a[0]||(a[0]=[o(`<h1 id="_4-4-2-使用本地存储-localstorage" tabindex="-1">4.4.2 使用本地存储（localStorage） <a class="header-anchor" href="#_4-4-2-使用本地存储-localstorage" aria-label="Permalink to &quot;4.4.2 使用本地存储（localStorage）&quot;">​</a></h1><blockquote><p><strong>本步目标</strong>：让 AI 帮我们实现数据的自动保存和读取</p></blockquote><p>本节是数据存储的核心实现。我们会分两步完成：先实现「保存」，再实现「读取」。</p><h2 id="技术小贴士-理解-localstorage" tabindex="-1">技术小贴士：理解 localStorage <a class="header-anchor" href="#技术小贴士-理解-localstorage" aria-label="Permalink to &quot;技术小贴士：理解 localStorage&quot;">​</a></h2><p>在开始之前，用一个生活类比帮你建立直觉：</p><table tabindex="0"><thead><tr><th>生活场景</th><th>对应概念</th></tr></thead><tbody><tr><td>快递寄存柜</td><td>localStorage</td></tr><tr><td>柜子编号（如 A-15）</td><td>存储的 key（键名）</td></tr><tr><td>柜子里的包裹</td><td>存储的 value（值）</td></tr><tr><td>存包裹</td><td><code>localStorage.setItem(key, value)</code></td></tr><tr><td>取包裹</td><td><code>localStorage.getItem(key)</code></td></tr></tbody></table><p>就像快递柜一样，localStorage 可以帮你&quot;寄存&quot;数据，下次来还能取回来。</p><div class="warning custom-block"><p class="custom-block-title">注意</p><p>localStorage 只能存储文本（字符串）。如果要存储任务列表这样的复杂数据，需要先把它转换成文本格式（JSON），取出来时再转回去。这个转换 AI 会自动帮你处理。</p></div><h2 id="步骤-1-添加保存和读取功能" tabindex="-1">步骤 1：添加保存和读取功能 <a class="header-anchor" href="#步骤-1-添加保存和读取功能" aria-label="Permalink to &quot;步骤 1：添加保存和读取功能&quot;">​</a></h2><p>我们用一个完整的 Prompt，让 AI 同时实现保存和读取逻辑。</p><h3 id="完整-prompt" tabindex="-1">完整 Prompt <a class="header-anchor" href="#完整-prompt" aria-label="Permalink to &quot;完整 Prompt&quot;">​</a></h3><p>复制下面的 Prompt，发送给你的 AI IDE：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>【背景】</span></span>
<span class="line"><span>我有一个待办清单网页，目前已经实现了添加、删除、标记完成的功能。</span></span>
<span class="line"><span>但刷新页面后，所有任务都会消失。</span></span>
<span class="line"><span>我需要添加数据持久化功能，让任务能够保存下来。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>【当前任务】</span></span>
<span class="line"><span>请帮我实现 localStorage 数据存储功能：</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. 保存功能：</span></span>
<span class="line"><span>   - 每当任务列表发生变化（添加、删除、完成状态改变）时</span></span>
<span class="line"><span>   - 自动将当前任务列表保存到 localStorage</span></span>
<span class="line"><span>   - 使用 &quot;todoList&quot; 作为存储的 key 名</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. 读取功能：</span></span>
<span class="line"><span>   - 页面加载时，自动从 localStorage 读取之前保存的任务</span></span>
<span class="line"><span>   - 如果有保存的数据，用它来初始化任务列表</span></span>
<span class="line"><span>   - 如果没有保存的数据（第一次使用），显示空列表</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. 数据格式：</span></span>
<span class="line"><span>   - 每个任务需要保存：任务内容、完成状态</span></span>
<span class="line"><span>   - 使用 JSON 格式存储</span></span>
<span class="line"><span></span></span>
<span class="line"><span>【技术要求】</span></span>
<span class="line"><span>- 使用原生 JavaScript</span></span>
<span class="line"><span>- 关键逻辑添加中文注释</span></span>
<span class="line"><span>- 确保保存和读取的数据格式一致</span></span>
<span class="line"><span></span></span>
<span class="line"><span>【我是初学者】</span></span>
<span class="line"><span>请保持代码简洁易懂，并解释关键的保存/读取逻辑。</span></span></code></pre></div><h3 id="预期结果" tabindex="-1">预期结果 <a class="header-anchor" href="#预期结果" aria-label="Permalink to &quot;预期结果&quot;">​</a></h3><p>发送 Prompt 后，AI 会更新你的代码。替换文件内容后：</p><ol><li><strong>表面上看起来没变化</strong> - 页面还是和之前一样</li><li><strong>但数据已经在自动保存了</strong> - 每次操作都会触发保存</li></ol><h3 id="如何确认保存生效" tabindex="-1">如何确认保存生效？ <a class="header-anchor" href="#如何确认保存生效" aria-label="Permalink to &quot;如何确认保存生效？&quot;">​</a></h3><p>用浏览器开发者工具查看：</p><ol><li>按 <strong>F12</strong> 打开开发者工具</li><li>点击顶部的 <strong>Application</strong>（应用程序）标签</li><li>在左侧找到 <strong>Storage &gt; Local Storage</strong></li><li>点击你的网页地址</li><li>你应该能看到一条 key 为 <code>todoList</code> 的数据</li></ol><div class="tip custom-block"><p class="custom-block-title">截图对照</p><p>如果操作正确，你会看到类似这样的界面：</p><ul><li>左侧：Local Storage &gt; <code>file://</code> 或你的网址</li><li>右侧：Key 列显示 <code>todoList</code>，Value 列显示类似 <code>[{&quot;text&quot;:&quot;买牛奶&quot;,&quot;completed&quot;:false}]</code> 的内容</li></ul></div><h3 id="检查点" tabindex="-1">检查点 <a class="header-anchor" href="#检查点" aria-label="Permalink to &quot;检查点&quot;">​</a></h3><p>在继续之前，确认以下几点：</p><ul><li>[ ] 代码更新后，页面能正常显示</li><li>[ ] 添加一个任务，开发者工具中能看到 <code>todoList</code> 数据</li><li>[ ] 再添加一个任务，<code>todoList</code> 的值会更新</li><li>[ ] 标记一个任务为完成，<code>todoList</code> 的值会更新</li><li>[ ] 删除一个任务，<code>todoList</code> 的值会更新</li></ul><h3 id="常见问题排查" tabindex="-1">常见问题排查 <a class="header-anchor" href="#常见问题排查" aria-label="Permalink to &quot;常见问题排查&quot;">​</a></h3><h4 id="问题-1-开发者工具中看不到-local-storage" tabindex="-1">问题 1：开发者工具中看不到 Local Storage <a class="header-anchor" href="#问题-1-开发者工具中看不到-local-storage" aria-label="Permalink to &quot;问题 1：开发者工具中看不到 Local Storage&quot;">​</a></h4><p><strong>可能原因</strong>：你可能打开的是 Console 或其他标签页。</p><p><strong>解决方法</strong>：</p><ul><li>确保点击的是 <strong>Application</strong> 标签（不是 Elements、Console 等）</li><li>如果找不到 Application，试试点击 <strong>&gt;&gt;</strong> 展开更多标签</li></ul><h4 id="问题-2-local-storage-中没有-todolist" tabindex="-1">问题 2：Local Storage 中没有 todoList <a class="header-anchor" href="#问题-2-local-storage-中没有-todolist" aria-label="Permalink to &quot;问题 2：Local Storage 中没有 todoList&quot;">​</a></h4><p><strong>可能原因</strong>：保存逻辑没有正确执行。</p><p><strong>修复 Prompt</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>我按照你的代码修改了，但是在浏览器的 Local Storage 中看不到 todoList 数据。</span></span>
<span class="line"><span>请检查保存逻辑，确保每次任务变化时都会调用 localStorage.setItem。</span></span>
<span class="line"><span>给我检查后的完整代码。</span></span></code></pre></div><h4 id="问题-3-todolist-的值是-undefined-或-object-object" tabindex="-1">问题 3：todoList 的值是 undefined 或 [object Object] <a class="header-anchor" href="#问题-3-todolist-的值是-undefined-或-object-object" aria-label="Permalink to &quot;问题 3：todoList 的值是 undefined 或 [object Object]&quot;">​</a></h4><p><strong>可能原因</strong>：数据没有正确转换为 JSON 字符串。</p><p><strong>修复 Prompt</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Local Storage 中的 todoList 值显示为 [object Object] 或 undefined。</span></span>
<span class="line"><span>请确保保存时使用 JSON.stringify 转换数据，读取时使用 JSON.parse 解析数据。</span></span>
<span class="line"><span>给我修复后的完整代码。</span></span></code></pre></div><h4 id="问题-4-页面报错-功能不正常" tabindex="-1">问题 4：页面报错，功能不正常 <a class="header-anchor" href="#问题-4-页面报错-功能不正常" aria-label="Permalink to &quot;问题 4：页面报错，功能不正常&quot;">​</a></h4><p><strong>排查步骤</strong>：</p><ol><li>按 F12 打开开发者工具</li><li>点击 <strong>Console</strong> 标签</li><li>查看红色的报错信息</li></ol><p><strong>修复 Prompt</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>更新代码后页面报错了。</span></span>
<span class="line"><span>控制台报错信息：[粘贴你看到的红色报错内容]</span></span>
<span class="line"><span>请帮我修复这个问题。</span></span></code></pre></div><h2 id="步骤-2-验证刷新后数据恢复" tabindex="-1">步骤 2：验证刷新后数据恢复 <a class="header-anchor" href="#步骤-2-验证刷新后数据恢复" aria-label="Permalink to &quot;步骤 2：验证刷新后数据恢复&quot;">​</a></h2><p>保存功能确认正常后，现在验证最关键的部分——<strong>刷新页面后数据是否还在</strong>。</p><h3 id="验证流程" tabindex="-1">验证流程 <a class="header-anchor" href="#验证流程" aria-label="Permalink to &quot;验证流程&quot;">​</a></h3><ol><li>确保当前有 1-2 个任务（如果没有，先添加几个）</li><li>标记其中一个为已完成</li><li><strong>刷新页面</strong>（按 F5 或点击浏览器刷新按钮）</li><li>检查结果</li></ol><h3 id="预期结果-1" tabindex="-1">预期结果 <a class="header-anchor" href="#预期结果-1" aria-label="Permalink to &quot;预期结果&quot;">​</a></h3><table tabindex="0"><thead><tr><th>检查项</th><th>刷新前</th><th>刷新后（预期）</th></tr></thead><tbody><tr><td>任务数量</td><td>2 个</td><td>2 个（不变）</td></tr><tr><td>任务内容</td><td>&quot;买牛奶&quot;、&quot;写报告&quot;</td><td>相同（不变）</td></tr><tr><td>完成状态</td><td>&quot;买牛奶&quot;已完成</td><td>仍然是已完成</td></tr></tbody></table><h3 id="如果刷新后数据丢失" tabindex="-1">如果刷新后数据丢失 <a class="header-anchor" href="#如果刷新后数据丢失" aria-label="Permalink to &quot;如果刷新后数据丢失&quot;">​</a></h3><p><strong>可能原因</strong>：读取逻辑没有正确执行。</p><p><strong>修复 Prompt</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>保存功能正常（我能在 Local Storage 中看到数据），</span></span>
<span class="line"><span>但刷新页面后，任务列表变空了，没有从 localStorage 读取数据。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>请检查页面加载时的读取逻辑，确保：</span></span>
<span class="line"><span>1. 页面加载时会调用 localStorage.getItem(&quot;todoList&quot;)</span></span>
<span class="line"><span>2. 读取到的数据会正确解析并显示在页面上</span></span>
<span class="line"><span></span></span>
<span class="line"><span>给我修复后的完整代码。</span></span></code></pre></div><h3 id="检查点-1" tabindex="-1">检查点 <a class="header-anchor" href="#检查点-1" aria-label="Permalink to &quot;检查点&quot;">​</a></h3><ul><li>[ ] 刷新页面后，之前添加的任务还在</li><li>[ ] 刷新页面后，任务的完成状态也保留了</li><li>[ ] 关闭浏览器标签页，重新打开文件，任务还在</li></ul><h2 id="技术小贴士-json-是什么" tabindex="-1">技术小贴士：JSON 是什么？ <a class="header-anchor" href="#技术小贴士-json-是什么" aria-label="Permalink to &quot;技术小贴士：JSON 是什么？&quot;">​</a></h2><p>你可能注意到 AI 的代码中使用了 <code>JSON.stringify</code> 和 <code>JSON.parse</code>。这里简单解释一下：</p><table tabindex="0"><thead><tr><th>方法</th><th>作用</th><th>类比</th></tr></thead><tbody><tr><td><code>JSON.stringify</code></td><td>把数据转换成文本</td><td>把衣服叠好装进行李箱</td></tr><tr><td><code>JSON.parse</code></td><td>把文本转换回数据</td><td>从行李箱里把衣服拿出来</td></tr></tbody></table><p>因为 localStorage 只能存储文本，所以：</p><ul><li><strong>存的时候</strong>：先用 <code>JSON.stringify</code> 把任务列表&quot;打包&quot;成文本</li><li><strong>取的时候</strong>：再用 <code>JSON.parse</code> 把文本&quot;解包&quot;还原成任务列表</li></ul><p>你不需要记住这些，只需要知道 AI 生成的代码中会包含这两个步骤。</p><h2 id="本步完成确认" tabindex="-1">本步完成确认 <a class="header-anchor" href="#本步完成确认" aria-label="Permalink to &quot;本步完成确认&quot;">​</a></h2><p>如果你已经：</p><ul><li>✅ 在开发者工具中能看到 <code>todoList</code> 数据</li><li>✅ 刷新页面后任务还在</li><li>✅ 完成状态也能保留</li></ul><p>恭喜！数据存储功能已经实现。接下来我们做更完整的测试。</p><p>→ <a href="./4.4.3-test-persistence.html">4.4.3 测试数据持久化</a></p>`,64)])])}const u=s(e,[["render",l]]);export{g as __pageData,u as default};
