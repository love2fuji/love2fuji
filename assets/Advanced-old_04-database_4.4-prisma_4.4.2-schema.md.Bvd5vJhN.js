import{_ as i,c as a,o as t,a3 as e}from"./chunks/framework.CUcrqFol.js";const c=JSON.parse('{"title":"4.4.2 Schema 文件结构：generator/datasource/model","description":"4.4.2 Schema 文件结构：generator/datasource/model 一句话破题 schema.prisma 是 Prisma 的核心配置文件——它定义了数据库连接、代码生成器和数据模型。 Schema 文件三大块 Generator：生成器配置 | 选项 | 说明 | |------|------","frontmatter":{"title":"4.4.2 Schema 文件结构：generator/datasource/model","typora-root-url":"../../public"},"headers":[],"relativePath":"Advanced-old/04-database/4.4-prisma/4.4.2-schema.md","filePath":"Advanced-old/04-database/4.4-prisma/4.4.2-schema.md","lastUpdated":1766168364000}'),n={name:"Advanced-old/04-database/4.4-prisma/4.4.2-schema.md"};function d(l,s,h,p,k,r){return t(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="_4-4-2-schema-文件结构-generator-datasource-model" tabindex="-1">4.4.2 Schema 文件结构：generator/datasource/model <a class="header-anchor" href="#_4-4-2-schema-文件结构-generator-datasource-model" aria-label="Permalink to &quot;4.4.2 Schema 文件结构：generator/datasource/model&quot;">​</a></h1><h3 id="一句话破题" tabindex="-1">一句话破题 <a class="header-anchor" href="#一句话破题" aria-label="Permalink to &quot;一句话破题&quot;">​</a></h3><p>schema.prisma 是 Prisma 的核心配置文件——它定义了数据库连接、代码生成器和数据模型。</p><h3 id="schema-文件三大块" tabindex="-1">Schema 文件三大块 <a class="header-anchor" href="#schema-文件三大块" aria-label="Permalink to &quot;Schema 文件三大块&quot;">​</a></h3><div class="language-prisma vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">prisma</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 1. 生成器配置（Generator）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">generator</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  provider </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;prisma-client-js&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 2. 数据源配置（Datasource）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">datasource</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  provider </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;postgresql&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  url      </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DATABASE_URL&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 3. 数据模型（Model）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">model</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cuid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  email </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @unique</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  posts </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Post</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="generator-生成器配置" tabindex="-1">Generator：生成器配置 <a class="header-anchor" href="#generator-生成器配置" aria-label="Permalink to &quot;Generator：生成器配置&quot;">​</a></h3><div class="language-prisma vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">prisma</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">generator</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  provider        </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;prisma-client-js&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 生成 JS/TS 客户端</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  previewFeatures </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fullTextSearch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 启用预览功能</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><table tabindex="0"><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td><code>provider</code></td><td>生成器类型，通常是 <code>prisma-client-js</code></td></tr><tr><td><code>previewFeatures</code></td><td>启用实验性功能</td></tr><tr><td><code>output</code></td><td>输出路径（通常不需要修改）</td></tr></tbody></table><h3 id="datasource-数据源配置" tabindex="-1">Datasource：数据源配置 <a class="header-anchor" href="#datasource-数据源配置" aria-label="Permalink to &quot;Datasource：数据源配置&quot;">​</a></h3><div class="language-prisma vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">prisma</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">datasource</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  provider </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;postgresql&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 数据库类型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  url      </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DATABASE_URL&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 从环境变量读取连接字符串</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>支持的数据库</strong>：</p><table tabindex="0"><thead><tr><th>provider</th><th>数据库</th></tr></thead><tbody><tr><td><code>postgresql</code></td><td>PostgreSQL</td></tr><tr><td><code>mysql</code></td><td>MySQL</td></tr><tr><td><code>sqlite</code></td><td>SQLite</td></tr><tr><td><code>sqlserver</code></td><td>SQL Server</td></tr><tr><td><code>mongodb</code></td><td>MongoDB</td></tr></tbody></table><h3 id="model-数据模型" tabindex="-1">Model：数据模型 <a class="header-anchor" href="#model-数据模型" aria-label="Permalink to &quot;Model：数据模型&quot;">​</a></h3><div class="language-prisma vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">prisma</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">model</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 字段定义</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   @id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cuid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  email     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   @unique</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  role      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Role</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     @default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">USER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  createdAt </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DateTime</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  updatedAt </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DateTime</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @updatedAt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 关系定义</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  posts     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Post</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  profile   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Profile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 枚举</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">enum</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Role</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  USER</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ADMIN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="常用字段修饰符" tabindex="-1">常用字段修饰符 <a class="header-anchor" href="#常用字段修饰符" aria-label="Permalink to &quot;常用字段修饰符&quot;">​</a></h3><table tabindex="0"><thead><tr><th>修饰符</th><th>作用</th><th>示例</th></tr></thead><tbody><tr><td><code>@id</code></td><td>主键</td><td><code>id String @id</code></td></tr><tr><td><code>@unique</code></td><td>唯一约束</td><td><code>email String @unique</code></td></tr><tr><td><code>@default()</code></td><td>默认值</td><td><code>@default(now())</code></td></tr><tr><td><code>@updatedAt</code></td><td>自动更新时间</td><td><code>updatedAt DateTime @updatedAt</code></td></tr><tr><td><code>@relation</code></td><td>定义关系</td><td><code>@relation(fields: [userId], references: [id])</code></td></tr><tr><td><code>@map</code></td><td>映射数据库字段名</td><td><code>@map(&quot;user_id&quot;)</code></td></tr><tr><td><code>@@index</code></td><td>创建索引</td><td><code>@@index([email])</code></td></tr><tr><td><code>@@unique</code></td><td>复合唯一约束</td><td><code>@@unique([userId, teamId])</code></td></tr></tbody></table><h3 id="字段类型速查" tabindex="-1">字段类型速查 <a class="header-anchor" href="#字段类型速查" aria-label="Permalink to &quot;字段类型速查&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Prisma 类型</th><th>TypeScript 类型</th><th>说明</th></tr></thead><tbody><tr><td><code>String</code></td><td><code>string</code></td><td>字符串</td></tr><tr><td><code>Int</code></td><td><code>number</code></td><td>整数</td></tr><tr><td><code>Float</code></td><td><code>number</code></td><td>浮点数</td></tr><tr><td><code>Boolean</code></td><td><code>boolean</code></td><td>布尔值</td></tr><tr><td><code>DateTime</code></td><td><code>Date</code></td><td>日期时间</td></tr><tr><td><code>Json</code></td><td><code>JsonValue</code></td><td>JSON 数据</td></tr><tr><td><code>Decimal</code></td><td><code>Decimal</code></td><td>精确小数</td></tr></tbody></table><p><strong>可选字段</strong>：类型后加 <code>?</code></p><div class="language-prisma vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">prisma</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name String?  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 可以为 null</span></span></code></pre></div><p><strong>数组字段</strong>：类型后加 <code>[]</code></p><div class="language-prisma vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">prisma</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tags String[]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 字符串数组</span></span></code></pre></div><h3 id="本节小结" tabindex="-1">本节小结 <a class="header-anchor" href="#本节小结" aria-label="Permalink to &quot;本节小结&quot;">​</a></h3><ul><li>schema.prisma 包含三部分：generator、datasource、model</li><li>generator 配置代码生成，datasource 配置数据库连接</li><li>model 定义数据结构和关系</li><li>使用修饰符（@id, @unique 等）定义约束</li></ul>`,24)])])}const E=i(n,[["render",d]]);export{c as __pageData,E as default};
