import{_ as k,C as r,c as d,o as i,a3 as t,b as h,w as a,a as l,G as e,a4 as p}from"./chunks/framework.CUcrqFol.js";const B=JSON.parse('{"title":"7.2.1 为什么 REST 这么流行——REST 约束：统一接口/无状态/可缓存","description":"7.2.1 REST 约束 一句话破题 REST 不是一个技术，而是一套设计约束——遵守这些约束，你的 API 就会变得简单、可预测、易扩展。 REST 六大约束 | 约束 | 含义 | 好处 | |------|------|------| | **客户端-服务器** | 前后端分离 | 各自独立演进 | | **无","frontmatter":{"title":"7.2.1 为什么 REST 这么流行——REST 约束：统一接口/无状态/可缓存","typora-root-url":"../../public"},"headers":[],"relativePath":"Advanced-old/07-api/7.2-error-handling/7.2.1-rest-constraints.md","filePath":"Advanced-old/07-api/7.2-error-handling/7.2.1-rest-constraints.md","lastUpdated":1766168364000}'),E={name:"Advanced-old/07-api/7.2-error-handling/7.2.1-rest-constraints.md"};function o(g,s,c,y,A,F){const n=r("Mermaid");return i(),d("div",null,[s[4]||(s[4]=t('<h1 id="_7-2-1-rest-约束" tabindex="-1">7.2.1 REST 约束 <a class="header-anchor" href="#_7-2-1-rest-约束" aria-label="Permalink to &quot;7.2.1 REST 约束&quot;">​</a></h1><h2 id="一句话破题" tabindex="-1">一句话破题 <a class="header-anchor" href="#一句话破题" aria-label="Permalink to &quot;一句话破题&quot;">​</a></h2><p>REST 不是一个技术，而是一套设计约束——遵守这些约束，你的 API 就会变得简单、可预测、易扩展。</p><h2 id="rest-六大约束" tabindex="-1">REST 六大约束 <a class="header-anchor" href="#rest-六大约束" aria-label="Permalink to &quot;REST 六大约束&quot;">​</a></h2>',4)),(i(),h(p,null,{default:a(()=>[e(n,{id:"mermaid-12",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20REST%5B%22REST%20%E6%9E%B6%E6%9E%84%22%5D%20--%3E%20C1%5B%22%E5%AE%A2%E6%88%B7%E7%AB%AF-%E6%9C%8D%E5%8A%A1%E5%99%A8%22%5D%0A%20%20%20%20REST%20--%3E%20C2%5B%22%E6%97%A0%E7%8A%B6%E6%80%81%22%5D%0A%20%20%20%20REST%20--%3E%20C3%5B%22%E5%8F%AF%E7%BC%93%E5%AD%98%22%5D%0A%20%20%20%20REST%20--%3E%20C4%5B%22%E7%BB%9F%E4%B8%80%E6%8E%A5%E5%8F%A3%22%5D%0A%20%20%20%20REST%20--%3E%20C5%5B%22%E5%88%86%E5%B1%82%E7%B3%BB%E7%BB%9F%22%5D%0A%20%20%20%20REST%20--%3E%20C6%5B%22%E6%8C%89%E9%9C%80%E4%BB%A3%E7%A0%81%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89%22%5D%0A"})]),fallback:a(()=>[...s[0]||(s[0]=[l(" Loading... ",-1)])]),_:1})),s[5]||(s[5]=t('<table tabindex="0"><thead><tr><th>约束</th><th>含义</th><th>好处</th></tr></thead><tbody><tr><td><strong>客户端-服务器</strong></td><td>前后端分离</td><td>各自独立演进</td></tr><tr><td><strong>无状态</strong></td><td>服务器不保存会话状态</td><td>易于扩展</td></tr><tr><td><strong>可缓存</strong></td><td>响应可以被缓存</td><td>提高性能</td></tr><tr><td><strong>统一接口</strong></td><td>使用标准的 HTTP 方法</td><td>接口可预测</td></tr><tr><td><strong>分层系统</strong></td><td>可以有中间层</td><td>灵活架构</td></tr><tr><td><strong>按需代码</strong></td><td>可下载可执行代码</td><td>可选特性</td></tr></tbody></table><h2 id="统一接口" tabindex="-1">统一接口 <a class="header-anchor" href="#统一接口" aria-label="Permalink to &quot;统一接口&quot;">​</a></h2><h3 id="核心原则" tabindex="-1">核心原则 <a class="header-anchor" href="#核心原则" aria-label="Permalink to &quot;核心原则&quot;">​</a></h3><p>统一接口是 REST 最重要的约束，包含四个子约束：</p>',4)),(i(),h(p,null,{default:a(()=>[e(n,{id:"mermaid-105",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20UI%5B%22%E7%BB%9F%E4%B8%80%E6%8E%A5%E5%8F%A3%22%5D%20--%3E%20R%5B%22%E8%B5%84%E6%BA%90%E6%A0%87%E8%AF%86%22%5D%0A%20%20%20%20UI%20--%3E%20M%5B%22%E8%B5%84%E6%BA%90%E6%93%8D%E4%BD%9C%22%5D%0A%20%20%20%20UI%20--%3E%20S%5B%22%E8%87%AA%E6%8F%8F%E8%BF%B0%E6%B6%88%E6%81%AF%22%5D%0A%20%20%20%20UI%20--%3E%20H%5B%22%E8%B6%85%E5%AA%92%E4%BD%93%E9%A9%B1%E5%8A%A8%22%5D%0A"})]),fallback:a(()=>[...s[1]||(s[1]=[l(" Loading... ",-1)])]),_:1})),s[6]||(s[6]=t(`<h3 id="资源标识" tabindex="-1">资源标识 <a class="header-anchor" href="#资源标识" aria-label="Permalink to &quot;资源标识&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 每个资源都有唯一的 URL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">users</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 用户资源</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">posts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">456</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 文章资源</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">users</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">posts  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 用户的文章</span></span></code></pre></div><h3 id="资源操作" tabindex="-1">资源操作 <a class="header-anchor" href="#资源操作" aria-label="Permalink to &quot;资源操作&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 通过 HTTP 方法表达操作意图</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">users</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // 读取</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">POST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">users       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 创建</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PUT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">users</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // 替换</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PATCH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">users</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // 更新</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">api</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">users</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // 删除</span></span></code></pre></div><h3 id="自描述消息" tabindex="-1">自描述消息 <a class="header-anchor" href="#自描述消息" aria-label="Permalink to &quot;自描述消息&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 请求头包含足够的元信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/users&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  headers: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Content-Type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;application/json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 告知请求体格式</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Accept&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;application/json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 期望响应格式</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Authorization&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Bearer xxx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 认证信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h2 id="无状态" tabindex="-1">无状态 <a class="header-anchor" href="#无状态" aria-label="Permalink to &quot;无状态&quot;">​</a></h2><h3 id="什么是无状态" tabindex="-1">什么是无状态 <a class="header-anchor" href="#什么是无状态" aria-label="Permalink to &quot;什么是无状态&quot;">​</a></h3>`,8)),(i(),h(p,null,{default:a(()=>[e(n,{id:"mermaid-124",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20subgraph%20Stateful%5B%22%E6%9C%89%E7%8A%B6%E6%80%81%EF%BC%88%E4%B8%8D%E6%8E%A8%E8%8D%90%EF%BC%89%22%5D%0A%20%20%20%20%20%20%20%20S1%5B%22%E8%AF%B7%E6%B1%82%201%3A%20%E7%99%BB%E5%BD%95%22%5D%20--%3E%20Server1%5B%22%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%B0%E4%BD%8F%E7%94%A8%E6%88%B7%22%5D%0A%20%20%20%20%20%20%20%20S2%5B%22%E8%AF%B7%E6%B1%82%202%3A%20%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%22%5D%20--%3E%20Server1%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20Stateless%5B%22%E6%97%A0%E7%8A%B6%E6%80%81%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89%22%5D%0A%20%20%20%20%20%20%20%20R1%5B%22%E8%AF%B7%E6%B1%82%201%20%2B%20Token%22%5D%20--%3E%20Server2%5B%22%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%AA%8C%E8%AF%81%22%5D%0A%20%20%20%20%20%20%20%20R2%5B%22%E8%AF%B7%E6%B1%82%202%20%2B%20Token%22%5D%20--%3E%20Server2%0A%20%20%20%20end%0A"})]),fallback:a(()=>[...s[2]||(s[2]=[l(" Loading... ",-1)])]),_:1})),s[7]||(s[7]=t(`<h3 id="无状态的实现" tabindex="-1">无状态的实现 <a class="header-anchor" href="#无状态的实现" aria-label="Permalink to &quot;无状态的实现&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 每个请求都携带完整的认证信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/users&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  headers: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Authorization&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`Bearer \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">token</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 每次都带 Token</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="好处" tabindex="-1">好处 <a class="header-anchor" href="#好处" aria-label="Permalink to &quot;好处&quot;">​</a></h3><table tabindex="0"><thead><tr><th>好处</th><th>说明</th></tr></thead><tbody><tr><td><strong>易扩展</strong></td><td>请求可以发到任意服务器</td></tr><tr><td><strong>高可用</strong></td><td>服务器挂了换一台即可</td></tr><tr><td><strong>简单</strong></td><td>不需要维护会话状态</td></tr></tbody></table><h2 id="可缓存" tabindex="-1">可缓存 <a class="header-anchor" href="#可缓存" aria-label="Permalink to &quot;可缓存&quot;">​</a></h2><h3 id="缓存控制头" tabindex="-1">缓存控制头 <a class="header-anchor" href="#缓存控制头" aria-label="Permalink to &quot;缓存控制头&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// app/api/posts/route.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> posts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getPosts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NextResponse.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(posts, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    headers: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;Cache-Control&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;public, max-age=60&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 可公开缓存，60秒有效</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;ETag&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">generateETag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(posts),            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 资源指纹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="常用缓存策略" tabindex="-1">常用缓存策略 <a class="header-anchor" href="#常用缓存策略" aria-label="Permalink to &quot;常用缓存策略&quot;">​</a></h3><table tabindex="0"><thead><tr><th>策略</th><th>Header</th><th>适用场景</th></tr></thead><tbody><tr><td><strong>不缓存</strong></td><td><code>no-store</code></td><td>敏感数据</td></tr><tr><td><strong>验证缓存</strong></td><td><code>no-cache</code></td><td>频繁更新</td></tr><tr><td><strong>短期缓存</strong></td><td><code>max-age=60</code></td><td>列表数据</td></tr><tr><td><strong>长期缓存</strong></td><td><code>max-age=31536000</code></td><td>静态资源</td></tr></tbody></table><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 不同场景的缓存策略</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cacheStrategies</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  sensitive: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;private, no-store&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 用户敏感数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  dynamic: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;private, no-cache&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 个人动态数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  shared: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;public, max-age=60&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 公共列表</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  static: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;public, max-age=31536000&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 静态资源</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="分层系统" tabindex="-1">分层系统 <a class="header-anchor" href="#分层系统" aria-label="Permalink to &quot;分层系统&quot;">​</a></h2>`,11)),(i(),h(p,null,{default:a(()=>[e(n,{id:"mermaid-245",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20Client%5B%22%E5%AE%A2%E6%88%B7%E7%AB%AF%22%5D%20--%3E%20CDN%5B%22CDN%22%5D%0A%20%20%20%20CDN%20--%3E%20Gateway%5B%22API%20%E7%BD%91%E5%85%B3%22%5D%0A%20%20%20%20Gateway%20--%3E%20LB%5B%22%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%22%5D%0A%20%20%20%20LB%20--%3E%20Server%5B%22%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%22%5D%0A"})]),fallback:a(()=>[...s[3]||(s[3]=[l(" Loading... ",-1)])]),_:1})),s[8]||(s[8]=t(`<p>客户端不需要知道中间有多少层，只需要知道最终的 API 地址。</p><h2 id="restful-vs-非-restful" tabindex="-1">RESTful vs 非 RESTful <a class="header-anchor" href="#restful-vs-非-restful" aria-label="Permalink to &quot;RESTful vs 非 RESTful&quot;">​</a></h2><table tabindex="0"><thead><tr><th>方面</th><th>RESTful</th><th>非 RESTful</th></tr></thead><tbody><tr><td>URL 设计</td><td><code>/api/users/123</code></td><td><code>/api/getUser?id=123</code></td></tr><tr><td>操作表达</td><td>HTTP 方法</td><td>URL 或参数</td></tr><tr><td>状态管理</td><td>Token</td><td>Session</td></tr><tr><td>缓存</td><td>HTTP 缓存头</td><td>自定义逻辑</td></tr></tbody></table><h2 id="觉知-常见误区" tabindex="-1">觉知：常见误区 <a class="header-anchor" href="#觉知-常见误区" aria-label="Permalink to &quot;觉知：常见误区&quot;">​</a></h2><h3 id="_1-把动作放到-url-里" tabindex="-1">1. 把动作放到 URL 里 <a class="header-anchor" href="#_1-把动作放到-url-里" aria-label="Permalink to &quot;1. 把动作放到 URL 里&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>❌ POST /api/createUser</span></span>
<span class="line"><span>❌ GET  /api/getUsers</span></span>
<span class="line"><span>❌ POST /api/deleteUser</span></span>
<span class="line"><span></span></span>
<span class="line"><span>✅ POST   /api/users</span></span>
<span class="line"><span>✅ GET    /api/users</span></span>
<span class="line"><span>✅ DELETE /api/users/123</span></span></code></pre></div><h3 id="_2-滥用-post" tabindex="-1">2. 滥用 POST <a class="header-anchor" href="#_2-滥用-post" aria-label="Permalink to &quot;2. 滥用 POST&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>❌ 所有操作都用 POST</span></span>
<span class="line"><span>   POST /api/users/get</span></span>
<span class="line"><span>   POST /api/users/delete</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>✅ 根据语义选择方法</span></span>
<span class="line"><span>   GET    /api/users</span></span>
<span class="line"><span>   DELETE /api/users/123</span></span></code></pre></div><h3 id="_3-不区分公开和私有缓存" tabindex="-1">3. 不区分公开和私有缓存 <a class="header-anchor" href="#_3-不区分公开和私有缓存" aria-label="Permalink to &quot;3. 不区分公开和私有缓存&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ❌ 用户私有数据使用公开缓存</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">headers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Cache-Control&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;public, max-age=3600&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ✅ 私有数据使用私有缓存</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">headers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Cache-Control&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;private, max-age=60&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div><h2 id="本节小结" tabindex="-1">本节小结 <a class="header-anchor" href="#本节小结" aria-label="Permalink to &quot;本节小结&quot;">​</a></h2><table tabindex="0"><thead><tr><th>要点</th><th>说明</th></tr></thead><tbody><tr><td><strong>统一接口</strong></td><td>用 HTTP 方法表达操作意图</td></tr><tr><td><strong>无状态</strong></td><td>每个请求携带完整信息</td></tr><tr><td><strong>可缓存</strong></td><td>利用 HTTP 缓存机制</td></tr><tr><td><strong>分层系统</strong></td><td>客户端不感知中间层</td></tr></tbody></table>`,12))])}const D=k(E,[["render",o]]);export{B as __pageData,D as default};
