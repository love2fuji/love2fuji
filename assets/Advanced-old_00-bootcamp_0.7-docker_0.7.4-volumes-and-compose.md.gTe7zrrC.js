import{_ as e,C as t,c as p,o as i,a3 as a,b as h,w as n,a as k,G as d,a4 as r}from"./chunks/framework.CUcrqFol.js";const F=JSON.parse('{"title":"0.7.4 程序关了数据还在吗——数据卷：持久化存储与数据管理","description":"0.7.4 程序关了数据还在吗——数据卷 一句话破题 容器数据是临时的，关了就没了。**数据卷 (Volumes)** 为数据保留“家”，让服务重启后数据仍在。 卷类型 命名卷：由 Docker 管理，跨容器共享，跨重启持久。 绑定挂载：把宿主机目录挂到容器内，适合开发或与宿主机文件交互。 命名卷示例 绑定挂载示例（W","frontmatter":{"title":"0.7.4 程序关了数据还在吗——数据卷：持久化存储与数据管理","typora-root-url":"../../public"},"headers":[],"relativePath":"Advanced-old/00-bootcamp/0.7-docker/0.7.4-volumes-and-compose.md","filePath":"Advanced-old/00-bootcamp/0.7-docker/0.7.4-volumes-and-compose.md","lastUpdated":1766168364000}'),E={name:"Advanced-old/00-bootcamp/0.7-docker/0.7.4-volumes-and-compose.md"};function o(c,s,g,y,u,m){const l=t("Mermaid");return i(),p("div",null,[s[1]||(s[1]=a(`<h1 id="_0-7-4-程序关了数据还在吗——数据卷" tabindex="-1">0.7.4 程序关了数据还在吗——数据卷 <a class="header-anchor" href="#_0-7-4-程序关了数据还在吗——数据卷" aria-label="Permalink to &quot;0.7.4 程序关了数据还在吗——数据卷&quot;">​</a></h1><h2 id="一句话破题" tabindex="-1">一句话破题 <a class="header-anchor" href="#一句话破题" aria-label="Permalink to &quot;一句话破题&quot;">​</a></h2><p>容器数据是临时的，关了就没了。<strong>数据卷 (Volumes)</strong> 为数据保留“家”，让服务重启后数据仍在。</p><h2 id="卷类型" tabindex="-1">卷类型 <a class="header-anchor" href="#卷类型" aria-label="Permalink to &quot;卷类型&quot;">​</a></h2><ul><li>命名卷：由 Docker 管理，跨容器共享，跨重启持久。</li><li>绑定挂载：把宿主机目录挂到容器内，适合开发或与宿主机文件交互。</li></ul><h2 id="命名卷示例" tabindex="-1">命名卷示例 <a class="header-anchor" href="#命名卷示例" aria-label="Permalink to &quot;命名卷示例&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker volume create pgdata</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker run </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name db </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5432</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5432</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v pgdata:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/var/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lib</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">postgresql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> postgres:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">alpine</span></span></code></pre></div><h2 id="绑定挂载示例-windows-路径" tabindex="-1">绑定挂载示例（Windows 路径） <a class="header-anchor" href="#绑定挂载示例-windows-路径" aria-label="Permalink to &quot;绑定挂载示例（Windows 路径）&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker run </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name app </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;D:\\\\data:/app/data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myapp:latest</span></span></code></pre></div><h2 id="compose-多服务编排" tabindex="-1">Compose：多服务编排 <a class="header-anchor" href="#compose-多服务编排" aria-label="Permalink to &quot;Compose：多服务编排&quot;">​</a></h2><p><code>docker-compose.yml</code></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;3.9&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">postgres:15-alpine</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;5432:5432&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">POSTGRES_PASSWORD=secret</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pgdata:/var/lib/postgresql/data</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">myapp:latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;3000:3000&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DB_URL=postgres://postgres:secret@db:5432/postgres</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    depends_on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">db</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  pgdata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span></code></pre></div><p>启动：<code>docker compose up -d</code>，查看：<code>docker compose ps</code>。</p><h2 id="可视化" tabindex="-1">可视化 <a class="header-anchor" href="#可视化" aria-label="Permalink to &quot;可视化&quot;">​</a></h2>`,14)),(i(),h(r,null,{default:n(()=>[d(l,{id:"mermaid-45",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20V%5B%E5%91%BD%E5%90%8D%E5%8D%B7%20pgdata%5D%20--%3E%20DB%5B%E5%AE%B9%E5%99%A8%20db%5D%0A%20%20%20%20DB%20--%3E%20APP%5B%E5%AE%B9%E5%99%A8%20app%5D%0A%20%20%20%20APP%20--%3E%20Host%5B%E5%AE%BF%E4%B8%BB%E6%9C%BA%E7%AB%AF%E5%8F%A3%203000%5D%0A"})]),fallback:n(()=>[...s[0]||(s[0]=[k(" Loading... ",-1)])]),_:1})),s[2]||(s[2]=a('<h2 id="觉知-持久化与可移植" tabindex="-1">觉知：持久化与可移植 <a class="header-anchor" href="#觉知-持久化与可移植" aria-label="Permalink to &quot;觉知：持久化与可移植&quot;">​</a></h2><ul><li>数据不要写进容器层；统一写入卷或绑定挂载。</li><li>在 Windows 下绑定路径时使用绝对路径；生产环境优先命名卷。</li></ul><h2 id="ai-协作指南" tabindex="-1">AI 协作指南 <a class="header-anchor" href="#ai-协作指南" aria-label="Permalink to &quot;AI 协作指南&quot;">​</a></h2><ul><li>核心意图：让 AI 生成“带持久化的 Compose 文件”。</li><li>需求定义公式： <ul><li>“生成一个包含 <code>app</code> 和 <code>db</code> 的 Compose，<code>db</code> 使用命名卷持久化数据，<code>app</code> 通过容器名连接数据库。”</li></ul></li></ul>',4))])}const b=e(E,[["render",o]]);export{F as __pageData,b as default};
