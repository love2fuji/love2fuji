import{_ as o,C as d,c as l,o as i,j as a,b as p,a3 as r,a as e,w as t,G as k,a4 as h}from"./chunks/framework.CUcrqFol.js";const b=JSON.parse('{"title":"10.3 一键启动所有服务——Docker Compose 编排：多服务协同","description":"10.3 一键启动所有服务——Docker Compose 编排：多服务协同 一个命令，启动整个应用栈。 为什么需要 Docker Compose 当你的应用不只有一个容器时（前端 + 后端 + 数据库 + 缓存），手动一个个启动既繁琐又容易出错。Docker Compose 让你用一个 YAML 文件定义所有服务，然","frontmatter":{"title":"10.3 一键启动所有服务——Docker Compose 编排：多服务协同","typora-root-url":"../../public"},"headers":[],"relativePath":"Advanced-old/10-deploy/10.3-docker-compose/index.md","filePath":"Advanced-old/10-deploy/10.3-docker-compose/index.md","lastUpdated":1766168364000}'),c={name:"Advanced-old/10-deploy/10.3-docker-compose/index.md"};function g(m,s,A,E,y,D){const n=d("Mermaid");return i(),l("div",null,[s[1]||(s[1]=a("h1",{id:"_10-3-一键启动所有服务——docker-compose-编排-多服务协同",tabindex:"-1"},[e("10.3 一键启动所有服务——Docker Compose 编排：多服务协同 "),a("a",{class:"header-anchor",href:"#_10-3-一键启动所有服务——docker-compose-编排-多服务协同","aria-label":'Permalink to "10.3 一键启动所有服务——Docker Compose 编排：多服务协同"'},"​")],-1)),s[2]||(s[2]=a("p",null,"一个命令，启动整个应用栈。",-1)),s[3]||(s[3]=a("h2",{id:"为什么需要-docker-compose",tabindex:"-1"},[e("为什么需要 Docker Compose "),a("a",{class:"header-anchor",href:"#为什么需要-docker-compose","aria-label":'Permalink to "为什么需要 Docker Compose"'},"​")],-1)),s[4]||(s[4]=a("p",null,"当你的应用不只有一个容器时（前端 + 后端 + 数据库 + 缓存），手动一个个启动既繁琐又容易出错。Docker Compose 让你用一个 YAML 文件定义所有服务，然后一键启动。",-1)),(i(),p(h,null,{default:t(()=>[k(n,{id:"mermaid-12",class:"mermaid",graph:"flowchart%20TB%0A%20%20%20%20subgraph%20%E6%89%8B%E5%8A%A8%E7%AE%A1%E7%90%86%0A%20%20%20%20%20%20%20%20A1%5Bdocker%20run%20postgres%5D%20--%3E%20A2%5Bdocker%20run%20redis%5D%0A%20%20%20%20%20%20%20%20A2%20--%3E%20A3%5Bdocker%20run%20nestjs%5D%0A%20%20%20%20%20%20%20%20A3%20--%3E%20A4%5Bdocker%20run%20nextjs%5D%0A%20%20%20%20%20%20%20%20A4%20--%3E%20A5%5Bdocker%20run%20nginx%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20Docker%20Compose%0A%20%20%20%20%20%20%20%20B1%5Bdocker%20compose%20up%5D%20--%3E%20B2%5B%E6%89%80%E6%9C%89%E6%9C%8D%E5%8A%A1%E5%90%8C%E6%97%B6%E5%90%AF%E5%8A%A8%5D%0A%20%20%20%20end%0A"})]),fallback:t(()=>[...s[0]||(s[0]=[e(" Loading... ",-1)])]),_:1})),s[5]||(s[5]=r(`<h2 id="核心优势" tabindex="-1">核心优势 <a class="header-anchor" href="#核心优势" aria-label="Permalink to &quot;核心优势&quot;">​</a></h2><table tabindex="0"><thead><tr><th>特性</th><th>说明</th></tr></thead><tbody><tr><td>声明式配置</td><td>用 YAML 描述期望状态，而非命令序列</td></tr><tr><td>一键操作</td><td><code>up</code> 启动、<code>down</code> 停止、<code>restart</code> 重启</td></tr><tr><td>依赖管理</td><td>自动按顺序启动有依赖关系的服务</td></tr><tr><td>网络隔离</td><td>自动创建专属网络，服务间用名称通信</td></tr><tr><td>环境一致</td><td>开发和生产使用相同的编排文件</td></tr></tbody></table><h2 id="典型应用栈" tabindex="-1">典型应用栈 <a class="header-anchor" href="#典型应用栈" aria-label="Permalink to &quot;典型应用栈&quot;">​</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># docker-compose.yml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  frontend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Next.js 前端</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  api</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># NestJS 后端</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  postgres</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PostgreSQL 数据库</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  redis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Redis 缓存</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  nginx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 反向代理</span></span></code></pre></div><h2 id="本节目录" tabindex="-1">本节目录 <a class="header-anchor" href="#本节目录" aria-label="Permalink to &quot;本节目录&quot;">​</a></h2><ul><li><strong>10.3.1 编排文件怎么写</strong> — Compose 文件结构详解</li><li><strong>10.3.2 服务之间如何对话</strong> — 网络与数据卷配置</li><li><strong>10.3.3 开发和生产用一套配置吗</strong> — 多环境配置策略</li><li><strong>10.3.4 服务挂了能自动重启吗</strong> — 健康检查与自愈</li></ul><h2 id="常用命令速查" tabindex="-1">常用命令速查 <a class="header-anchor" href="#常用命令速查" aria-label="Permalink to &quot;常用命令速查&quot;">​</a></h2><table tabindex="0"><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>docker compose up -d</code></td><td>后台启动所有服务</td></tr><tr><td><code>docker compose down</code></td><td>停止并删除容器</td></tr><tr><td><code>docker compose ps</code></td><td>查看服务状态</td></tr><tr><td><code>docker compose logs -f</code></td><td>实时查看日志</td></tr><tr><td><code>docker compose restart api</code></td><td>重启指定服务</td></tr><tr><td><code>docker compose pull</code></td><td>拉取最新镜像</td></tr><tr><td><code>docker compose build</code></td><td>构建自定义镜像</td></tr></tbody></table><h2 id="快速上手" tabindex="-1">快速上手 <a class="header-anchor" href="#快速上手" aria-label="Permalink to &quot;快速上手&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 创建 docker-compose.yml</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 启动所有服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 查看状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. 查看日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> api</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. 停止服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> down</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">版本说明</p><p>Docker Compose V2 已集成到 Docker CLI，命令从 <code>docker-compose</code> 变为 <code>docker compose</code>（去掉了连字符）。</p></div>`,11))])}const C=o(c,[["render",g]]);export{b as __pageData,C as default};
