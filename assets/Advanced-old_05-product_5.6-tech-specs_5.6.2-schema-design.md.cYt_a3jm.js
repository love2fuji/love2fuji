import{_ as l,C as t,c as e,o as a,a3 as i,b as h,w as n,a as k,G as d,a4 as r}from"./chunks/framework.CUcrqFol.js";const m=JSON.parse('{"title":"5.6.2 数据该怎么存——数据表设计：实体关系图与字段定义","description":"5.6.2 数据该怎么存——数据表设计 一句话破题 数据表设计回答一个问题：**数据以什么结构存储、表与表之间有什么关系**。 实体关系图（ER 图） 先画图，再建表： 关系类型 | 关系 | 符号 | 示例 | |------|------|------| | 一对一 | | User - Profile | | 一","frontmatter":{"title":"5.6.2 数据该怎么存——数据表设计：实体关系图与字段定义","typora-root-url":"../../public"},"headers":[],"relativePath":"Advanced-old/05-product/5.6-tech-specs/5.6.2-schema-design.md","filePath":"Advanced-old/05-product/5.6-tech-specs/5.6.2-schema-design.md","lastUpdated":1766168364000}'),E={name:"Advanced-old/05-product/5.6-tech-specs/5.6.2-schema-design.md"};function g(c,s,o,y,F,u){const p=t("Mermaid");return a(),e("div",null,[s[1]||(s[1]=i('<h1 id="_5-6-2-数据该怎么存——数据表设计" tabindex="-1">5.6.2 数据该怎么存——数据表设计 <a class="header-anchor" href="#_5-6-2-数据该怎么存——数据表设计" aria-label="Permalink to &quot;5.6.2 数据该怎么存——数据表设计&quot;">​</a></h1><h3 id="一句话破题" tabindex="-1">一句话破题 <a class="header-anchor" href="#一句话破题" aria-label="Permalink to &quot;一句话破题&quot;">​</a></h3><p>数据表设计回答一个问题：<strong>数据以什么结构存储、表与表之间有什么关系</strong>。</p><h3 id="实体关系图-er-图" tabindex="-1">实体关系图（ER 图） <a class="header-anchor" href="#实体关系图-er-图" aria-label="Permalink to &quot;实体关系图（ER 图）&quot;">​</a></h3><p>先画图，再建表：</p>',5)),(a(),h(r,null,{default:n(()=>[d(p,{id:"mermaid-15",class:"mermaid",graph:"erDiagram%0A%20%20%20%20User%20%7C%7C--o%7B%20Post%20%3A%20writes%0A%20%20%20%20Post%20%7Do--%7C%7C%20Category%20%3A%20belongs_to%0A%20%20%20%20Post%20%7Do--o%7B%20Tag%20%3A%20has%0A%20%20%20%20%0A%20%20%20%20User%20%7B%0A%20%20%20%20%20%20%20%20string%20id%20PK%0A%20%20%20%20%20%20%20%20string%20email%20UK%0A%20%20%20%20%20%20%20%20string%20name%0A%20%20%20%20%20%20%20%20datetime%20createdAt%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20Post%20%7B%0A%20%20%20%20%20%20%20%20string%20id%20PK%0A%20%20%20%20%20%20%20%20string%20title%0A%20%20%20%20%20%20%20%20string%20content%0A%20%20%20%20%20%20%20%20string%20slug%20UK%0A%20%20%20%20%20%20%20%20string%20userId%20FK%0A%20%20%20%20%20%20%20%20string%20categoryId%20FK%0A%20%20%20%20%20%20%20%20datetime%20createdAt%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20Category%20%7B%0A%20%20%20%20%20%20%20%20string%20id%20PK%0A%20%20%20%20%20%20%20%20string%20name%20UK%0A%20%20%20%20%20%20%20%20string%20slug%20UK%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20Tag%20%7B%0A%20%20%20%20%20%20%20%20string%20id%20PK%0A%20%20%20%20%20%20%20%20string%20name%20UK%0A%20%20%20%20%7D%0A"})]),fallback:n(()=>[...s[0]||(s[0]=[k(" Loading... ",-1)])]),_:1})),s[2]||(s[2]=i(`<h3 id="关系类型" tabindex="-1">关系类型 <a class="header-anchor" href="#关系类型" aria-label="Permalink to &quot;关系类型&quot;">​</a></h3><table tabindex="0"><thead><tr><th>关系</th><th>符号</th><th>示例</th></tr></thead><tbody><tr><td>一对一</td><td>\`</td><td></td></tr><tr><td>一对多</td><td>\`</td><td></td></tr><tr><td>多对多</td><td><code>}o--o{</code></td><td>Post - Tags</td></tr></tbody></table><h3 id="字段定义模板" tabindex="-1">字段定义模板 <a class="header-anchor" href="#字段定义模板" aria-label="Permalink to &quot;字段定义模板&quot;">​</a></h3><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## Post 表</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| 字段 | 类型 | 约束 | 说明 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|------|------|------|------|</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| id | string | PK | 主键，使用 cuid |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| title | string | NOT NULL | 标题，1-100 字符 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| content | text | NOT NULL | 内容，Markdown 格式 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| slug | string | UNIQUE | URL 友好标识 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| status | enum | DEFAULT &#39;draft&#39; | draft/published |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| userId | string | FK → User.id | 作者 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| categoryId | string | FK → Category.id | 分类 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| createdAt | datetime | DEFAULT now() | 创建时间 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">| updatedAt | datetime | AUTO UPDATE | 更新时间 |</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### 索引</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`slug\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> - 唯一索引，用于 URL 查询</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`userId\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> - 普通索引，用于按作者筛选</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \`createdAt\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> - 普通索引，用于排序</span></span></code></pre></div><h3 id="prisma-schema-示例" tabindex="-1">Prisma Schema 示例 <a class="header-anchor" href="#prisma-schema-示例" aria-label="Permalink to &quot;Prisma Schema 示例&quot;">​</a></h3><div class="language-prisma vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">prisma</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">model</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Post</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    @id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cuid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  title      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  content    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  slug       </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    @unique</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  status     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Status</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    @default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DRAFT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  author     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">User</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      @relation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fields</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">references</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  userId     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  category   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Category</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  @relation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fields</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">categoryId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">references</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  categoryId </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tags       </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  createdAt  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DateTime</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  @default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  updatedAt  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DateTime</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  @updatedAt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  @@index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  @@index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">createdAt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">enum</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  DRAFT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  PUBLISHED</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="设计原则" tabindex="-1">设计原则 <a class="header-anchor" href="#设计原则" aria-label="Permalink to &quot;设计原则&quot;">​</a></h3><h4 id="_1-主键设计" tabindex="-1">1. 主键设计 <a class="header-anchor" href="#_1-主键设计" aria-label="Permalink to &quot;1. 主键设计&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>✅ 使用 cuid 或 uuid</span></span>
<span class="line"><span>   - 不暴露业务信息</span></span>
<span class="line"><span>   - 支持分布式生成</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>❌ 使用自增 ID</span></span>
<span class="line"><span>   - 容易被猜测</span></span>
<span class="line"><span>   - 合并数据时冲突</span></span></code></pre></div><h4 id="_2-时间字段" tabindex="-1">2. 时间字段 <a class="header-anchor" href="#_2-时间字段" aria-label="Permalink to &quot;2. 时间字段&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>每张表都应该有：</span></span>
<span class="line"><span>- createdAt：记录创建时间</span></span>
<span class="line"><span>- updatedAt：记录最后更新时间</span></span>
<span class="line"><span></span></span>
<span class="line"><span>可选：</span></span>
<span class="line"><span>- deletedAt：软删除标记</span></span></code></pre></div><h4 id="_3-外键处理" tabindex="-1">3. 外键处理 <a class="header-anchor" href="#_3-外键处理" aria-label="Permalink to &quot;3. 外键处理&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>删除关联数据时的策略：</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CASCADE  - 级联删除（删用户时删文章）</span></span>
<span class="line"><span>SET NULL - 设为空（删分类时文章分类设空）</span></span>
<span class="line"><span>RESTRICT - 禁止删除（有文章时不能删分类）</span></span></code></pre></div><h3 id="常见设计模式" tabindex="-1">常见设计模式 <a class="header-anchor" href="#常见设计模式" aria-label="Permalink to &quot;常见设计模式&quot;">​</a></h3><h4 id="多对多关系" tabindex="-1">多对多关系 <a class="header-anchor" href="#多对多关系" aria-label="Permalink to &quot;多对多关系&quot;">​</a></h4><div class="language-prisma vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">prisma</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 方案一：隐式中间表（Prisma 自动创建）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">model</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Post</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tags </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tag</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">model</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  posts </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Post</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 方案二：显式中间表（需要额外字段时）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">model</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PostTag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  post    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Post</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     @relation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fields</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">postId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">references</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  postId  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tag     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tag</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      @relation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fields</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tagId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">references</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tagId   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  order   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 额外字段：排序</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  @@id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">postId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tagId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="软删除" tabindex="-1">软删除 <a class="header-anchor" href="#软删除" aria-label="Permalink to &quot;软删除&quot;">​</a></h4><div class="language-prisma vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">prisma</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">model</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Post</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  deletedAt </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DateTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 查询时过滤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">const posts = await prisma.post.findMany({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  where: { deletedAt: null }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="让-ai-帮你设计数据表" tabindex="-1">让 AI 帮你设计数据表 <a class="header-anchor" href="#让-ai-帮你设计数据表" aria-label="Permalink to &quot;让 AI 帮你设计数据表&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>你：博客系统需要哪些数据表？请给出 Prisma Schema</span></span>
<span class="line"><span></span></span>
<span class="line"><span>AI：// prisma/schema.prisma</span></span>
<span class="line"><span></span></span>
<span class="line"><span>model User {</span></span>
<span class="line"><span>  id       String @id @default(cuid())</span></span>
<span class="line"><span>  email    String @unique</span></span>
<span class="line"><span>  name     String</span></span>
<span class="line"><span>  password String</span></span>
<span class="line"><span>  posts    Post[]</span></span>
<span class="line"><span>  createdAt DateTime @default(now())</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>model Post {</span></span>
<span class="line"><span>  id         String   @id @default(cuid())</span></span>
<span class="line"><span>  title      String</span></span>
<span class="line"><span>  content    String</span></span>
<span class="line"><span>  slug       String   @unique</span></span>
<span class="line"><span>  published  Boolean  @default(false)</span></span>
<span class="line"><span>  author     User     @relation(fields: [authorId], references: [id])</span></span>
<span class="line"><span>  authorId   String</span></span>
<span class="line"><span>  category   Category @relation(fields: [categoryId], references: [id])</span></span>
<span class="line"><span>  categoryId String</span></span>
<span class="line"><span>  tags       Tag[]</span></span>
<span class="line"><span>  createdAt  DateTime @default(now())</span></span>
<span class="line"><span>  updatedAt  DateTime @updatedAt</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>model Category {</span></span>
<span class="line"><span>  id    String @id @default(cuid())</span></span>
<span class="line"><span>  name  String @unique</span></span>
<span class="line"><span>  slug  String @unique</span></span>
<span class="line"><span>  posts Post[]</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>model Tag {</span></span>
<span class="line"><span>  id    String @id @default(cuid())</span></span>
<span class="line"><span>  name  String @unique</span></span>
<span class="line"><span>  posts Post[]</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="实用建议" tabindex="-1">实用建议 <a class="header-anchor" href="#实用建议" aria-label="Permalink to &quot;实用建议&quot;">​</a></h3><ol><li><strong>先画 ER 图</strong>：可视化帮助理清关系</li><li><strong>命名一致</strong>：字段命名风格统一（camelCase 或 snake_case）</li><li><strong>适度冗余</strong>：为了查询效率，可以适当冗余</li><li><strong>预留扩展</strong>：考虑未来可能的需求</li></ol>`,22))])}const A=l(E,[["render",g]]);export{m as __pageData,A as default};
