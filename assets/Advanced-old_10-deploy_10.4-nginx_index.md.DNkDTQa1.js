import{_ as r,C as k,c as o,o as t,j as a,b as e,a3 as p,a as i,w as n,G as h,a4 as d}from"./chunks/framework.CUcrqFol.js";const F=JSON.parse('{"title":"10.4 网站的交通指挥官——反向代理与负载均衡：Nginx 配置实战","description":"10.4 网站的交通指挥官——反向代理与负载均衡：Nginx 配置实战 用户访问的是域名，Nginx 决定请求去哪。 为什么需要 Nginx Nginx 在现代 Web 架构中扮演着\\"门卫\\"角色： 核心功能 | 功能 | 说明 | |------|------| | 反向代理 | 将请求转发到后端服务 | | SSL","frontmatter":{"title":"10.4 网站的交通指挥官——反向代理与负载均衡：Nginx 配置实战","typora-root-url":"../../public"},"headers":[],"relativePath":"Advanced-old/10-deploy/10.4-nginx/index.md","filePath":"Advanced-old/10-deploy/10.4-nginx/index.md","lastUpdated":1766168364000}'),g={name:"Advanced-old/10-deploy/10.4-nginx/index.md"};function E(c,s,A,x,y,B){const l=k("Mermaid");return t(),o("div",null,[s[2]||(s[2]=a("h1",{id:"_10-4-网站的交通指挥官——反向代理与负载均衡-nginx-配置实战",tabindex:"-1"},[i("10.4 网站的交通指挥官——反向代理与负载均衡：Nginx 配置实战 "),a("a",{class:"header-anchor",href:"#_10-4-网站的交通指挥官——反向代理与负载均衡-nginx-配置实战","aria-label":'Permalink to "10.4 网站的交通指挥官——反向代理与负载均衡：Nginx 配置实战"'},"​")],-1)),s[3]||(s[3]=a("p",null,"用户访问的是域名，Nginx 决定请求去哪。",-1)),s[4]||(s[4]=a("h2",{id:"为什么需要-nginx",tabindex:"-1"},[i("为什么需要 Nginx "),a("a",{class:"header-anchor",href:"#为什么需要-nginx","aria-label":'Permalink to "为什么需要 Nginx"'},"​")],-1)),s[5]||(s[5]=a("p",null,'Nginx 在现代 Web 架构中扮演着"门卫"角色：',-1)),(t(),e(d,null,{default:n(()=>[h(l,{id:"mermaid-12",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20A%5B%E7%94%A8%E6%88%B7%5D%20--%3E%7CHTTPS%7C%20B%5BNginx%5D%0A%20%20%20%20B%20--%3E%7CHTTP%7C%20C%5BNext.js%20%3A3000%5D%0A%20%20%20%20B%20--%3E%7CHTTP%7C%20D%5BNestJS%20%3A3001%5D%0A%20%20%20%20B%20--%3E%7C%E7%9B%B4%E6%8E%A5%E8%BF%94%E5%9B%9E%7C%20E%5B%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%5D%0A"})]),fallback:n(()=>[...s[0]||(s[0]=[i(" Loading... ",-1)])]),_:1})),s[6]||(s[6]=p('<h2 id="核心功能" tabindex="-1">核心功能 <a class="header-anchor" href="#核心功能" aria-label="Permalink to &quot;核心功能&quot;">​</a></h2><table tabindex="0"><thead><tr><th>功能</th><th>说明</th></tr></thead><tbody><tr><td>反向代理</td><td>将请求转发到后端服务</td></tr><tr><td>SSL 终止</td><td>处理 HTTPS 加密/解密</td></tr><tr><td>负载均衡</td><td>将请求分发到多个实例</td></tr><tr><td>静态文件</td><td>直接返回静态资源</td></tr><tr><td>缓存</td><td>缓存响应，减少后端压力</td></tr><tr><td>压缩</td><td>Gzip 压缩响应内容</td></tr></tbody></table><h2 id="_1panel-中的-nginx" tabindex="-1">1Panel 中的 Nginx <a class="header-anchor" href="#_1panel-中的-nginx" aria-label="Permalink to &quot;1Panel 中的 Nginx&quot;">​</a></h2><p>1Panel 默认使用 <strong>OpenResty</strong>（Nginx 的增强版），通过 <strong>网站</strong> 功能管理：</p><table tabindex="0"><thead><tr><th>操作</th><th>路径</th></tr></thead><tbody><tr><td>创建网站</td><td>网站 → 网站 → 创建网站</td></tr><tr><td>配置反向代理</td><td>网站 → 选择站点 → 反向代理</td></tr><tr><td>SSL 证书</td><td>网站 → 选择站点 → HTTPS</td></tr><tr><td>查看配置</td><td>网站 → 选择站点 → 配置文件</td></tr></tbody></table><h2 id="本节目录" tabindex="-1">本节目录 <a class="header-anchor" href="#本节目录" aria-label="Permalink to &quot;本节目录&quot;">​</a></h2><ul><li><strong>10.4.1 请求该转发给谁</strong> — 反向代理基础配置</li><li><strong>10.4.2 HTTPS 证书怎么配</strong> — SSL 配置与自动续期</li><li><strong>10.4.3 用户太多了怎么办</strong> — 负载均衡策略</li><li><strong>10.4.4 图片如何加速访问</strong> — 静态资源与 CDN</li></ul><h2 id="典型配置架构" tabindex="-1">典型配置架构 <a class="header-anchor" href="#典型配置架构" aria-label="Permalink to &quot;典型配置架构&quot;">​</a></h2>',8)),(t(),e(d,null,{default:n(()=>[h(l,{id:"mermaid-158",class:"mermaid",graph:"flowchart%20TB%0A%20%20%20%20subgraph%20%E4%BA%92%E8%81%94%E7%BD%91%0A%20%20%20%20%20%20%20%20A%5B%E7%94%A8%E6%88%B7%E6%B5%8F%E8%A7%88%E5%99%A8%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20%E6%9C%8D%E5%8A%A1%E5%99%A8%0A%20%20%20%20%20%20%20%20B%5BNginx%20%3A80%2F443%5D%0A%20%20%20%20%20%20%20%20C%5BNext.js%20%3A3000%5D%0A%20%20%20%20%20%20%20%20D%5BNestJS%20%3A3001%5D%0A%20%20%20%20%20%20%20%20E%5B%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20A%20--%3E%7Cwww.example.com%7C%20B%0A%20%20%20%20A%20--%3E%7Capi.example.com%7C%20B%0A%20%20%20%20B%20--%3E%7C%2F%7C%20C%0A%20%20%20%20B%20--%3E%7C%2Fapi%7C%20D%0A%20%20%20%20B%20--%3E%7C%2F_next%2Fstatic%7C%20E%0A"})]),fallback:n(()=>[...s[1]||(s[1]=[i(" Loading... ",-1)])]),_:1})),s[7]||(s[7]=p(`<h2 id="常用命令" tabindex="-1">常用命令 <a class="header-anchor" href="#常用命令" aria-label="Permalink to &quot;常用命令&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试配置语法</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重载配置（不中断服务）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reload</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看 Nginx 状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看访问日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/log/nginx/access.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看错误日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/log/nginx/error.log</span></span></code></pre></div><h2 id="配置文件结构" tabindex="-1">配置文件结构 <a class="header-anchor" href="#配置文件结构" aria-label="Permalink to &quot;配置文件结构&quot;">​</a></h2><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /etc/nginx/nginx.conf 主配置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 全局设置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    include </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/etc/nginx/conf.d/*.conf;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 包含站点配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /etc/nginx/conf.d/example.conf 站点配置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example.com;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://localhost:3000;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>`,4))])}const D=r(g,[["render",E]]);export{F as __pageData,D as default};
