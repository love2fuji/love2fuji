import{_ as l,C as h,c as p,o as n,j as a,b as d,a3 as k,a as i,w as t,G as r,a4 as o}from"./chunks/framework.CUcrqFol.js";const x=JSON.parse('{"title":"10.2.3 Next.js 项目怎么部署——Next.js 部署示例：生产构建与端口配置","description":"10.2.3 Next.js 项目怎么部署——Next.js 部署示例：生产构建与端口配置 Next.js 部署的核心：先构建，后运行。 部署流程概览 步骤一：编写 Dockerfile 在项目根目录创建 ： 关键配置说明 | 配置 | 作用 | |------|------| | | 多阶段构建，减小最终镜像体积 |","frontmatter":{"title":"10.2.3 Next.js 项目怎么部署——Next.js 部署示例：生产构建与端口配置","typora-root-url":"../../public"},"headers":[],"relativePath":"Advanced-old/10-deploy/10.2-1panel-deployment/10.2.3-nextjs-deploy.md","filePath":"Advanced-old/10-deploy/10.2-1panel-deployment/10.2.3-nextjs-deploy.md","lastUpdated":1766168364000}'),c={name:"Advanced-old/10-deploy/10.2-1panel-deployment/10.2.3-nextjs-deploy.md"};function E(g,s,y,F,u,b){const e=h("Mermaid");return n(),p("div",null,[s[1]||(s[1]=a("h1",{id:"_10-2-3-next-js-项目怎么部署——next-js-部署示例-生产构建与端口配置",tabindex:"-1"},[i("10.2.3 Next.js 项目怎么部署——Next.js 部署示例：生产构建与端口配置 "),a("a",{class:"header-anchor",href:"#_10-2-3-next-js-项目怎么部署——next-js-部署示例-生产构建与端口配置","aria-label":'Permalink to "10.2.3 Next.js 项目怎么部署——Next.js 部署示例：生产构建与端口配置"'},"​")],-1)),s[2]||(s[2]=a("p",null,"Next.js 部署的核心：先构建，后运行。",-1)),s[3]||(s[3]=a("h2",{id:"部署流程概览",tabindex:"-1"},[i("部署流程概览 "),a("a",{class:"header-anchor",href:"#部署流程概览","aria-label":'Permalink to "部署流程概览"'},"​")],-1)),(n(),d(o,null,{default:t(()=>[r(e,{id:"mermaid-9",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20A%5B%E6%9C%AC%E5%9C%B0%E4%BB%A3%E7%A0%81%5D%20--%3E%20B%5B%E6%9E%84%E5%BB%BADocker%E9%95%9C%E5%83%8F%5D%0A%20%20%20%20B%20--%3E%20C%5B%E6%8E%A8%E9%80%81%E5%88%B0%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%5D%0A%20%20%20%20C%20--%3E%20D%5B1Panel%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F%5D%0A%20%20%20%20D%20--%3E%20E%5B%E9%85%8D%E7%BD%AE%E5%B9%B6%E5%90%AF%E5%8A%A8%5D%0A%20%20%20%20E%20--%3E%20F%5B%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%5D%0A%20%20%20%20F%20--%3E%20G%5B%E7%94%A8%E6%88%B7%E8%AE%BF%E9%97%AE%5D%0A"})]),fallback:t(()=>[...s[0]||(s[0]=[i(" Loading... ",-1)])]),_:1})),s[4]||(s[4]=k(`<h2 id="步骤一-编写-dockerfile" tabindex="-1">步骤一：编写 Dockerfile <a class="header-anchor" href="#步骤一-编写-dockerfile" aria-label="Permalink to &quot;步骤一：编写 Dockerfile&quot;">​</a></h2><p>在项目根目录创建 <code>Dockerfile</code>：</p><div class="language-dockerfile vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">dockerfile</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 构建阶段</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> node:18-alpine </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> builder</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WORKDIR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /app</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装依赖</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> package*.json ./</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> npm ci</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 复制源码并构建</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> . .</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> npm run build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 生产阶段</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> node:18-alpine </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> runner</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WORKDIR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /app</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NODE_ENV=production</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 复制构建产物</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --from=builder /app/.next/standalone ./</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --from=builder /app/.next/static ./.next/static</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --from=builder /app/public ./public</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">EXPOSE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 3000</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CMD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;server.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><h3 id="关键配置说明" tabindex="-1">关键配置说明 <a class="header-anchor" href="#关键配置说明" aria-label="Permalink to &quot;关键配置说明&quot;">​</a></h3><table tabindex="0"><thead><tr><th>配置</th><th>作用</th></tr></thead><tbody><tr><td><code>AS builder</code></td><td>多阶段构建，减小最终镜像体积</td></tr><tr><td><code>npm ci</code></td><td>比 <code>npm install</code> 更快更可靠</td></tr><tr><td><code>standalone</code></td><td>Next.js 13+ 的独立输出模式</td></tr></tbody></table><h3 id="启用-standalone-模式" tabindex="-1">启用 Standalone 模式 <a class="header-anchor" href="#启用-standalone-模式" aria-label="Permalink to &quot;启用 Standalone 模式&quot;">​</a></h3><p>在 <code>next.config.js</code> 中添加：</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/** </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {import(&#39;next&#39;).NextConfig}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nextConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  output: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;standalone&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nextConfig</span></span></code></pre></div><h2 id="步骤二-构建并推送镜像" tabindex="-1">步骤二：构建并推送镜像 <a class="header-anchor" href="#步骤二-构建并推送镜像" aria-label="Permalink to &quot;步骤二：构建并推送镜像&quot;">​</a></h2><h3 id="本地构建" tabindex="-1">本地构建 <a class="header-anchor" href="#本地构建" aria-label="Permalink to &quot;本地构建&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 构建镜像</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-nextjs-app:v1.0.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试运行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3000:3000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-nextjs-app:v1.0.0</span></span></code></pre></div><h3 id="推送到镜像仓库" tabindex="-1">推送到镜像仓库 <a class="header-anchor" href="#推送到镜像仓库" aria-label="Permalink to &quot;推送到镜像仓库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 登录阿里云镜像仓库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> login</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.cn-hangzhou.aliyuncs.com</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 打标签</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tag</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-nextjs-app:v1.0.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.cn-hangzhou.aliyuncs.com/your-namespace/my-nextjs-app:v1.0.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 推送</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.cn-hangzhou.aliyuncs.com/your-namespace/my-nextjs-app:v1.0.0</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">镜像仓库选择</p><ul><li><strong>阿里云 ACR</strong>：国内访问快，免费额度</li><li><strong>腾讯云 TCR</strong>：与腾讯云服务集成好</li><li><strong>Docker Hub</strong>：国际通用，国内访问慢</li></ul></div><h2 id="步骤三-在-1panel-中部署" tabindex="-1">步骤三：在 1Panel 中部署 <a class="header-anchor" href="#步骤三-在-1panel-中部署" aria-label="Permalink to &quot;步骤三：在 1Panel 中部署&quot;">​</a></h2><h3 id="创建容器配置" tabindex="-1">创建容器配置 <a class="header-anchor" href="#创建容器配置" aria-label="Permalink to &quot;创建容器配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th>配置项</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>镜像</td><td><code>registry.cn-hangzhou.aliyuncs.com/xxx/my-nextjs-app:v1.0.0</code></td><td>完整镜像地址</td></tr><tr><td>容器名</td><td><code>nextjs-frontend</code></td><td>便于识别</td></tr><tr><td>端口映射</td><td><code>3000:3000</code></td><td>外部:内部</td></tr><tr><td>重启策略</td><td><code>always</code></td><td>崩溃自动重启</td></tr></tbody></table><h3 id="环境变量配置" tabindex="-1">环境变量配置 <a class="header-anchor" href="#环境变量配置" aria-label="Permalink to &quot;环境变量配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th>变量名</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td><code>NODE_ENV</code></td><td><code>production</code></td><td>生产模式</td></tr><tr><td><code>NEXT_PUBLIC_API_URL</code></td><td><code>https://api.example.com</code></td><td>后端 API 地址</td></tr></tbody></table><h3 id="健康检查配置" tabindex="-1">健康检查配置 <a class="header-anchor" href="#健康检查配置" aria-label="Permalink to &quot;健康检查配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th>配置项</th><th>值</th></tr></thead><tbody><tr><td>检查方式</td><td>HTTP GET</td></tr><tr><td>路径</td><td><code>/api/health</code> 或 <code>/</code></td></tr><tr><td>端口</td><td><code>3000</code></td></tr><tr><td>间隔</td><td><code>30s</code></td></tr><tr><td>超时</td><td><code>10s</code></td></tr></tbody></table><h2 id="步骤四-配置反向代理" tabindex="-1">步骤四：配置反向代理 <a class="header-anchor" href="#步骤四-配置反向代理" aria-label="Permalink to &quot;步骤四：配置反向代理&quot;">​</a></h2><p>在 1Panel 的 <strong>网站</strong> → <strong>网站</strong> 中创建反向代理：</p><table tabindex="0"><thead><tr><th>配置项</th><th>值</th></tr></thead><tbody><tr><td>域名</td><td><code>www.example.com</code></td></tr><tr><td>代理地址</td><td><code>127.0.0.1:3000</code></td></tr><tr><td>HTTPS</td><td>开启，申请免费证书</td></tr></tbody></table><h3 id="nginx-配置示例" tabindex="-1">Nginx 配置示例 <a class="header-anchor" href="#nginx-配置示例" aria-label="Permalink to &quot;Nginx 配置示例&quot;">​</a></h3><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">www.example.com;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 301</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> https://$server_name$request_uri;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ssl http2;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">www.example.com;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ssl_certificate </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/path/to/cert.pem;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ssl_certificate_key </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/path/to/key.pem;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://127.0.0.1:3000;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_http_version </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Upgrade $http_upgrade;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Connection </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;upgrade&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Host $host;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_cache_bypass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$http_upgrade;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="验证部署" tabindex="-1">验证部署 <a class="header-anchor" href="#验证部署" aria-label="Permalink to &quot;验证部署&quot;">​</a></h2><h3 id="检查容器状态" tabindex="-1">检查容器状态 <a class="header-anchor" href="#检查容器状态" aria-label="Permalink to &quot;检查容器状态&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看容器日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nextjs-frontend</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看容器状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nextjs</span></span></code></pre></div><h3 id="测试访问" tabindex="-1">测试访问 <a class="header-anchor" href="#测试访问" aria-label="Permalink to &quot;测试访问&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 本地测试</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:3000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 域名测试</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://www.example.com</span></span></code></pre></div><h2 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to &quot;常见问题&quot;">​</a></h2><table tabindex="0"><thead><tr><th>问题</th><th>原因</th><th>解决方案</th></tr></thead><tbody><tr><td>启动失败</td><td>缺少 standalone 配置</td><td>添加 <code>output: &#39;standalone&#39;</code></td></tr><tr><td>静态资源 404</td><td>未复制 static 目录</td><td>检查 Dockerfile COPY 命令</td></tr><tr><td>环境变量不生效</td><td>使用了 NEXT_PUBLIC_ 前缀</td><td>构建时注入，或改用服务端变量</td></tr><tr><td>内存溢出</td><td>内存不足</td><td>增加服务器内存或优化代码</td></tr></tbody></table><h2 id="ai-协作指南" tabindex="-1">AI 协作指南 <a class="header-anchor" href="#ai-协作指南" aria-label="Permalink to &quot;AI 协作指南&quot;">​</a></h2><p>向 AI 描述 Next.js 部署问题时：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>我的 Next.js 应用部署后访问显示 502，</span></span>
<span class="line"><span>使用 App Router，Next.js 版本 14.x，</span></span>
<span class="line"><span>容器日志显示：[具体错误信息]</span></span>
<span class="line"><span>请帮我分析原因。</span></span></code></pre></div><p><strong>关键术语</strong>：standalone、多阶段构建、反向代理、NEXT_PUBLIC_ 环境变量</p>`,37))])}const C=l(c,[["render",E]]);export{x as __pageData,C as default};
