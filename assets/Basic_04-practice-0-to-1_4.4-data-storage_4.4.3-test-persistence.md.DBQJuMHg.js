import{_ as t,c as s,o as i,a3 as e}from"./chunks/framework.CUcrqFol.js";const u=JSON.parse('{"title":"4.4.3 测试数据持久化","description":"4.4.3 测试数据持久化 **本步目标**：通过多种场景验证数据存储功能是否完善 在 4.4.2 中，我们已经初步验证了刷新后数据还在。本节进行更全面的测试，确保各种情况下数据都能正确保存。 五步验证法 按照以下步骤，系统性地测试数据持久化功能： 步骤 1：准备测试数据 如果当前有任务，先全部删除（从一个干净的状态开","frontmatter":{"title":"4.4.3 测试数据持久化","order":4},"headers":[],"relativePath":"Basic/04-practice-0-to-1/4.4-data-storage/4.4.3-test-persistence.md","filePath":"Basic/04-practice-0-to-1/4.4-data-storage/4.4.3-test-persistence.md","lastUpdated":1765094268000}'),l={name:"Basic/04-practice-0-to-1/4.4-data-storage/4.4.3-test-persistence.md"};function n(o,a,p,d,r,h){return i(),s("div",null,[...a[0]||(a[0]=[e(`<h1 id="_4-4-3-测试数据持久化" tabindex="-1">4.4.3 测试数据持久化 <a class="header-anchor" href="#_4-4-3-测试数据持久化" aria-label="Permalink to &quot;4.4.3 测试数据持久化&quot;">​</a></h1><blockquote><p><strong>本步目标</strong>：通过多种场景验证数据存储功能是否完善</p></blockquote><p>在 4.4.2 中，我们已经初步验证了刷新后数据还在。本节进行更全面的测试，确保各种情况下数据都能正确保存。</p><h2 id="五步验证法" tabindex="-1">五步验证法 <a class="header-anchor" href="#五步验证法" aria-label="Permalink to &quot;五步验证法&quot;">​</a></h2><p>按照以下步骤，系统性地测试数据持久化功能：</p><h3 id="步骤-1-准备测试数据" tabindex="-1">步骤 1：准备测试数据 <a class="header-anchor" href="#步骤-1-准备测试数据" aria-label="Permalink to &quot;步骤 1：准备测试数据&quot;">​</a></h3><ol><li>如果当前有任务，先全部删除（从一个干净的状态开始）</li><li>添加 3 个任务： <ul><li>&quot;学习 Vibe Coding&quot;</li><li>&quot;完成待办清单项目&quot;</li><li>&quot;庆祝一下&quot;</li></ul></li></ol><h3 id="步骤-2-修改任务状态" tabindex="-1">步骤 2：修改任务状态 <a class="header-anchor" href="#步骤-2-修改任务状态" aria-label="Permalink to &quot;步骤 2：修改任务状态&quot;">​</a></h3><ol><li>将 &quot;学习 Vibe Coding&quot; 标记为已完成</li><li>确认它有视觉变化（删除线或变灰）</li></ol><h3 id="步骤-3-刷新页面测试" tabindex="-1">步骤 3：刷新页面测试 <a class="header-anchor" href="#步骤-3-刷新页面测试" aria-label="Permalink to &quot;步骤 3：刷新页面测试&quot;">​</a></h3><ol><li>按 <strong>F5</strong> 或 <strong>Ctrl+R</strong>（Mac: Cmd+R）刷新页面</li><li>检查结果：</li></ol><table tabindex="0"><thead><tr><th>检查项</th><th>预期结果</th></tr></thead><tbody><tr><td>任务数量</td><td>3 个</td></tr><tr><td>&quot;学习 Vibe Coding&quot;</td><td>仍然是已完成状态</td></tr><tr><td>其他两个任务</td><td>仍然是未完成状态</td></tr></tbody></table><h3 id="步骤-4-关闭标签页测试" tabindex="-1">步骤 4：关闭标签页测试 <a class="header-anchor" href="#步骤-4-关闭标签页测试" aria-label="Permalink to &quot;步骤 4：关闭标签页测试&quot;">​</a></h3><p>这是更严格的测试：</p><ol><li>完全关闭当前浏览器标签页</li><li>重新打开 HTML 文件（或重新访问网址）</li><li>检查结果：任务列表应该和关闭前一样</li></ol><h3 id="步骤-5-删除操作测试" tabindex="-1">步骤 5：删除操作测试 <a class="header-anchor" href="#步骤-5-删除操作测试" aria-label="Permalink to &quot;步骤 5：删除操作测试&quot;">​</a></h3><ol><li>删除 &quot;庆祝一下&quot; 这个任务</li><li>刷新页面</li><li>检查结果：应该只剩 2 个任务，&quot;庆祝一下&quot; 不应该回来</li></ol><h2 id="如何查看-localstorage-中的原始数据" tabindex="-1">如何查看 localStorage 中的原始数据 <a class="header-anchor" href="#如何查看-localstorage-中的原始数据" aria-label="Permalink to &quot;如何查看 localStorage 中的原始数据&quot;">​</a></h2><p>有时候需要直接查看存储的数据内容，可以这样操作：</p><ol><li>按 <strong>F12</strong> 打开开发者工具</li><li>点击 <strong>Application</strong> 标签</li><li>展开左侧的 <strong>Storage &gt; Local Storage</strong></li><li>点击你的网页地址（如 <code>file://</code> 或 <code>localhost</code>）</li><li>在右侧找到 Key 为 <code>todoList</code> 的那一行</li><li>双击 Value 列可以查看完整内容</li></ol><p><strong>正确的数据格式示例</strong>：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;text&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;学习 Vibe Coding&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;completed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;text&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;完成待办清单项目&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;completed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p><p>如果你的数据格式和上面不完全一样也没关系，只要包含任务内容和完成状态两个信息即可。不同的 AI 可能会使用不同的属性名（如 <code>content</code> 代替 <code>text</code>，<code>done</code> 代替 <code>completed</code>）。</p></div><h2 id="测试检查清单" tabindex="-1">测试检查清单 <a class="header-anchor" href="#测试检查清单" aria-label="Permalink to &quot;测试检查清单&quot;">​</a></h2><p>完成所有测试后，确认以下项目都通过：</p><ul><li>[ ] 添加任务后，刷新页面任务还在</li><li>[ ] 删除任务后，刷新页面任务不会回来</li><li>[ ] 标记完成后，刷新页面完成状态保留</li><li>[ ] 取消完成后，刷新页面状态正确更新</li><li>[ ] 关闭标签页再打开，数据完整保留</li><li>[ ] 在开发者工具中能看到 <code>todoList</code> 数据</li></ul><h2 id="常见问题排查" tabindex="-1">常见问题排查 <a class="header-anchor" href="#常见问题排查" aria-label="Permalink to &quot;常见问题排查&quot;">​</a></h2><h3 id="问题-1-刷新后所有任务消失" tabindex="-1">问题 1：刷新后所有任务消失 <a class="header-anchor" href="#问题-1-刷新后所有任务消失" aria-label="Permalink to &quot;问题 1：刷新后所有任务消失&quot;">​</a></h3><table tabindex="0"><thead><tr><th>可能原因</th><th>排查方法</th></tr></thead><tbody><tr><td>保存逻辑没执行</td><td>检查开发者工具中有没有 <code>todoList</code></td></tr><tr><td>读取逻辑没执行</td><td>有 <code>todoList</code> 但页面空白</td></tr><tr><td>数据格式错误</td><td><code>todoList</code> 值是乱码或 undefined</td></tr></tbody></table><p><strong>通用修复 Prompt</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>刷新页面后任务都消失了。</span></span>
<span class="line"><span>我在开发者工具的 Local Storage 中 [能看到/看不到] todoList 数据。</span></span>
<span class="line"><span>请帮我检查保存和读取逻辑，确保：</span></span>
<span class="line"><span>1. 每次任务变化都会保存到 localStorage</span></span>
<span class="line"><span>2. 页面加载时会读取并显示保存的数据</span></span>
<span class="line"><span>给我修复后的完整代码。</span></span></code></pre></div><h3 id="问题-2-任务内容在-但完成状态丢失" tabindex="-1">问题 2：任务内容在，但完成状态丢失 <a class="header-anchor" href="#问题-2-任务内容在-但完成状态丢失" aria-label="Permalink to &quot;问题 2：任务内容在，但完成状态丢失&quot;">​</a></h3><p><strong>可能原因</strong>：保存时没有包含 <code>completed</code> 状态。</p><p><strong>修复 Prompt</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>刷新页面后任务内容还在，但所有任务都变成未完成状态了。</span></span>
<span class="line"><span>请检查保存逻辑，确保每个任务对象都包含完成状态（completed 或 done 属性）。</span></span>
<span class="line"><span>给我修复后的完整代码。</span></span></code></pre></div><h3 id="问题-3-删除的任务刷新后又回来了" tabindex="-1">问题 3：删除的任务刷新后又回来了 <a class="header-anchor" href="#问题-3-删除的任务刷新后又回来了" aria-label="Permalink to &quot;问题 3：删除的任务刷新后又回来了&quot;">​</a></h3><p><strong>可能原因</strong>：删除操作后没有更新 localStorage。</p><p><strong>修复 Prompt</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>我删除了一个任务，但刷新页面后它又出现了。</span></span>
<span class="line"><span>请确保删除任务后会立即更新 localStorage 中的数据。</span></span>
<span class="line"><span>给我修复后的完整代码。</span></span></code></pre></div><h3 id="问题-4-控制台报错-json-相关错误" tabindex="-1">问题 4：控制台报错 JSON 相关错误 <a class="header-anchor" href="#问题-4-控制台报错-json-相关错误" aria-label="Permalink to &quot;问题 4：控制台报错 JSON 相关错误&quot;">​</a></h3><p>常见报错如：</p><ul><li><code>SyntaxError: Unexpected token</code></li><li><code>JSON.parse: unexpected character</code></li></ul><p><strong>修复 Prompt</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>控制台报错：[粘贴具体报错信息]</span></span>
<span class="line"><span>这似乎是 JSON 解析相关的问题。</span></span>
<span class="line"><span>请检查 localStorage 数据的保存和读取逻辑，确保格式正确。</span></span>
<span class="line"><span>给我修复后的完整代码。</span></span></code></pre></div><h2 id="本节检查点" tabindex="-1">本节检查点 <a class="header-anchor" href="#本节检查点" aria-label="Permalink to &quot;本节检查点&quot;">​</a></h2><p>在继续之前，确认：</p><ul><li>[ ] 完成了五步验证法的所有测试</li><li>[ ] 所有测试场景都通过</li><li>[ ] 没有控制台报错</li></ul><p>全部通过后，进入最后的完整功能验证。</p><p>→ <a href="./4.4.4-final-verification.html">4.4.4 完整功能验证</a></p>`,49)])])}const k=t(l,[["render",n]]);export{u as __pageData,k as default};
